
        var searchCount=0,IsMSCOM=!0,scope="mscom",searchInputTop,index=0,inputTxt="";function autocompleteInit(){searchCount=$("div.search_control div.search_textbox input").length;setId4Searchbox();$("div.search_control div.search_border").each(function(b){var a=$(this).find("div.search_textbox input");a.click(function(){onInputClick($(this))});if(b>0){addWatermark(a);setTitle4Ele(a,$("input[name="+scope+"]").val())}setautocomplete(a,b+1);a.focusin(function(){searchInputFocusin($(this))});a.focusout(function(){searchInputFoucsout($(this))})});initTopInputStyle();$("div.search_control .search_border .search_button input").focusin(function(){var a=$(this).parent().siblings(".search_textbox").children(".ui-autocomplete-input");a.hasClass("txtItalic")&&a.val("")});$("div.search_control .search_border .search_button input").focusout(function(){var a=$(this).parent().siblings(".search_textbox").children(".ui-autocomplete-input");a.hasClass("txtItalic")&&a.val(a.attr("title"))});$("div.search_control form").submit(function(){return onSubmit($(this))});$("div.mainContainer ul.ui-autocomplete div.inlineScopeClass ul li a").live("click",function(){onScopeClick($(this))});$("div.header").parent().parent().css("z-index","999")}function initTopInputStyle(){removeCssClass(searchInputTop,"txtItalic");setTitle4Ele(searchInputTop,$("input[name="+scope+"]").val());$.trim(searchInputTop.val())==""&&searchInputTop[0].focus()}function removeCssClass(b,a){b.removeClass(a)}function addCssClass(b,a){b.addClass(a)}function setTitle4Ele(a,b){a.attr("title",b)}function setId4Searchbox(){$("div.search_control div.search_border").each(function(a){$(this).attr("id","searchBox"+(a+1));$(this).find("div.search_textbox input").attr("id","searchInput"+(a+1));$(this).find("div.mainContainer").attr("id","mainContainer"+(a+1));$(this).find("div.mainContainer div.menuresults").attr("id","menuresults"+(a+1))});searchInputTop=$("#searchInput1")}function addWatermark(a){if($.trim(a.val())==""){addCssClass(a,"txtItalic");a.val($("input[name="+scope+"]").val())}}function arrowUp(e,c,b){e.stopImmediatePropagation();var d=$("#mainContainer"+b+" ul.ui-autocomplete li").length,f=$("#mainContainer"+b+" ul.ui-autocomplete li.hovered"),a=$("#mainContainer"+b+" ul.ui-autocomplete li").index(f);if(a==-1){$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+(d-1)+")").addClass("hovered");c.val(inputTxt)}else if(a==0){$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+a+")").removeClass("hovered");c.val(inputTxt)}else{$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+a+")").removeClass("hovered");$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+(a-1)+")").addClass("hovered");if(a==d-1||a==+d)c.val(inputTxt);else c.val($("#mainContainer"+b+" ul.ui-autocomplete li:eq("+(a-1)+")").text())}if(e.preventDefault){e.preventDefault();return!1}}function arrowDown(f,c,b){f.stopImmediatePropagation();var d=$("#mainContainer"+b+" ul.ui-autocomplete li").length,e=$("#mainContainer"+b+" ul.ui-autocomplete li.hovered"),a=$("#mainContainer"+b+" ul.ui-autocomplete li").index(e);if(a==d-1){$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+a+")").removeClass("hovered");c.val(inputTxt)}else{$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+a+")").removeClass("hovered");$("#mainContainer"+b+" ul.ui-autocomplete li:eq("+(a+1)+")").addClass("hovered");if(a==d-2||a==d-3)c.val(inputTxt);else c.val($("#mainContainer"+b+" ul.ui-autocomplete li:eq("+(a+1)+")").text())}}function pressEnter(b,c){b.stopImmediatePropagation();var e=$("#mainContainer"+c+" ul.ui-autocomplete li").length,a=$("#mainContainer"+c+" ul.ui-autocomplete li.hovered"),d=$("#mainContainer"+c+" ul.ui-autocomplete li").index(a);if(d==e-1){a.siblings().find("a").removeClass("checkedScope");$("a",a).addClass("checkedScope");scope=$("a",a).attr("id");changeMSCOM();if(b.preventDefault){b.preventDefault();return!1}}if(d==e-2){a.siblings().find("a").removeClass("checkedScope");$("a",a).addClass("checkedScope");scope=$("a",a).attr("id");changeMSCOM();if(b.preventDefault){b.preventDefault();return!1}}}function onAutocomOpen(c){c.parent().parent().find("div.mainContainer").addClass("ac_results");var b=c.autocomplete("widget");b.css("left","0");b.css("top","0");var a=c.val().toLowerCase();b.find("li.ui-menu-item a").each(function(){var b=$(this).text().toLowerCase(),c=b.search(a)+a.length,d="";if(c>=a.length){d=b.substr(c);$(this).html(a+"<b>"+d+"</b>")}else $(this).html(b)});b.append(buildScopeList())}function onAutocomSelect(b,a){a.val(b.item.value);a.autocomplete("widget").hide();a.parent().parent().parent().submit();return!1}function buildScopeList(){var a='<div class="inlineScopeClass" ><ul>',b=$("div.search_control:first").find("input.scope").each(function(){if($(this).attr("name")==scope)a=a+'<li ><a id="'+$(this).attr("name")+'" class="checkedScope" bi:track="false">'+$(this).val()+" </a></li>";else a=a+'<li ><a id="'+$(this).attr("name")+'" bi:track="false">'+$(this).val()+" </a></li>"});a=a+"</ul></div> ";return a}function onInputClick(b){var a=b.parent().parent().find("div.mainContainer ul.ui-autocomplete");a.find("div.inlineScopeClass").length==0&&a.append(buildScopeList());if($.trim(b.val())==""){b.parent().parent().find("div.mainContainer").removeClass("ac_results");a.find("li.ui-menu-item").remove()}inputTxt=b.val();a.show()}function setautocomplete(a,b){var d=$("input[name=AutoSuggestionLocale]").val();if(d=="")d="en-us";var e=$("input[name=AutoSuggestionScope]").val(),c="mscom";if(e=="1")c="mscomdl";else if(e=="2")c="mscomsp";else c="mscom";a.keydown(function(d){var e=$(this).autocomplete("widget").is(":visible"),c=$.ui.keyCode;if(e)switch(d.keyCode){case c.UP:arrowUp(d,a,b);break;case c.DOWN:arrowDown(d,a,b);break;case c.ENTER:case c.SPACE:pressEnter(d,b)}});a.autocomplete({source:function(e,b){$.ajax({url:"/Shared/Templates/Master/smcPage/AutoSuggestHandler.ashx?q="+encodeURIComponent(a.val())+"&site=smc&scope="+c+"&locale="+d+"&cb=?",dataType:"jsonp",type:"GET",success:function(d){var c=$.map(d,function(a){return a});if(c.length>0){c.splice(0,1);inputTxt=a.val()}if(c.length==0){inputTxt="";removeSuggestion()}b(c)}})},delay:300,select:function(b,a){onAutocomSelect(a,$(this))},open:function(){onAutocomOpen($(this))},appendTo:"#mainContainer"+b});a.keyup(function(a){if(a.keyCode=="27"){$("#mainContainer"+b+"ul.ui-autocomplete").hide();return}$.trim($(this).val()).length==0||inputTxt==$.trim($(this).val())});scopeMouseEnter(b);scopeMouseLeave(b)}function removeSuggestion(){$("div.mainContainer > ul.ui-autocomplete li:not(div.inlineScopeClass ul li)").remove();$("div.mainContainer").removeClass("ac_results")}function scopeMouseEnter(a){$("#mainContainer"+a+" ul.ui-autocomplete li").live("mouseenter",function(){$("#mainContainer"+a+" ul.ui-autocomplete").find("li").removeClass("hovered");$(this).addClass("hovered")})}function scopeMouseLeave(a){$("#mainContainer"+a+" ul.ui-autocomplete div.inlineScopeClass ul li").live("mouseleave",function(){$(this).removeClass("hovered")})}function searchInputFocusin(a){if(a.hasClass("txtItalic")){a.removeClass("txtItalic");a.val("")}a.parent().parent().addClass("search_border_z")}function searchInputFoucsout(a){if($.trim(a.val())==""){var b=a.parentsUntil("form").find("div.mainContainer ul.ui-autocomplete");if(!b.find("div.inlineScopeClass ul li").hasClass("hovered")){a.addClass("txtItalic");a.val(a.attr("title"))}b.parent().removeClass("ac_results");b.find("li.ui-menu-item").remove()}a.parent().parent().removeClass("search_border_z")}function onScopeClick(a){a.parent().siblings().find("a").removeClass("checkedScope");a.addClass("checkedScope");scope=a.attr("id");changeMSCOM();a.parentsUntil("form").find("div.search_textbox input").focus();addWatermark(a)}function changeMSCOM(){var a=$("div.search_control div.search_textbox input");a.attr("title",$("input[name="+scope+"]").val())}function onSubmit(a){a.find("input:text").each(function(){$(this).val($.trim($(this).val().replace(/\s{2,}/g," ")))});var b=$("div.search_border .search_textbox",a).find("input:first");b.hasClass("txtItalic")&&b.val("");if(scope=="web"){var c=a.find("input:text").val();window.location.href="http://www.bing.com/search?q="+encodeURIComponent(c)+"&FORM=BMME";return!1}else return!0}function correctQueryInputValue(){var a=getQueryValue();a!=null&&$("div.search_textbox input").each(function(){$(this).val()!=null&&$(this).val(a)})}function getQueryValue(){var c=null;if(location.search!=null&&location.search.length>0)for(var b=location.search.substr(1).split("&"),f=b.length,a=0;a<f;a++){var e=b[a],d=e.indexOf("q=");if(d>-1){c=decodeURIComponent(e.substr(d+2).replace(/\+/g," "));break}}return c}var searchwithBing=function(b,a){$("div.search_with_bing a").bind("click",function(){var e,g=/q=([^&]*)/i,d=g.exec(location);if(d!=null)e=$.trim(d[1]);if(e==null){var c=$("div.search_textbox input"),f=c.hasClass("txtItalic")?"":encodeURIComponent(c.val());$(this).attr("href",b+$.trim(f+a))}})}
